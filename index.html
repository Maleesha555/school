<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Management System | Admin Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fa-solid fa-graduation-cap"></i>
                </div>
                <span>Sri Rahula School</span>
            </div>
            <nav class="nav-links">
                <a href="#" class="nav-item active" data-target="section-students"><i class="fa-solid fa-users"></i>
                    Students Directory</a>
                <a href="#" class="nav-item" data-target="section-markbook"><i class="fa-solid fa-book-open"></i>
                    Academic Markbook</a>
                <a href="#" class="nav-item" data-target="section-analysis"><i class="fa-solid fa-chart-line"></i>
                    Historical Analysis</a>
                <a href="#" class="nav-item" data-target="section-promotion"><i class="fa-solid fa-award"></i> Promotion
                    & Reporting</a>
                <a href="#"><i class="fa-solid fa-gear"></i> System Settings</a>
                <div class="spacer"></div>
                <a href="#" class="logout"><i class="fa-solid fa-arrow-right-from-bracket"></i> Lock System</a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="topbar">
                <div class="search-container">
                    <i class="fa-solid fa-magnifying-glass"></i>
                    <input type="text" id="searchInput" placeholder="Search by Admission ID or Full Name...">
                </div>
                <div class="user-profile">
                    <div class="avatar-info">
                        <span class="role">System Administrator</span>
                    </div>
                    <div class="avatar"><i class="fa-solid fa-user-shield"></i></div>
                </div>
            </header>

            <div class="scrollable">
                <div id="section-students" class="page-section active">
                    <div class="content-header">
                        <div>
                            <h1>Students Directory</h1>
                            <p>Manage all student admissions, records, and guardian details</p>
                        </div>
                        <button id="addStudentBtn" class="primary-btn">
                            <i class="fa-solid fa-plus"></i> New Admission
                        </button>
                    </div>

                    <div class="table-container glass-panel">
                        <table id="studentsTable">
                            <thead>
                                <tr>
                                    <th>Admission ID</th>
                                    <th>Full Name</th>
                                    <th>Age</th>
                                    <th>Guardian Name</th>
                                    <th>Guardian Contact</th>
                                    <th>Admitted On</th>
                                    <th class="actions-col">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTableBody">
                                <!-- Student rows injected via JS -->
                            </tbody>
                        </table>
                        <div id="noDataMessage" class="no-data hidden">
                            <div class="icon-circle">
                                <i class="fa-solid fa-folder-open"></i>
                            </div>
                            <h3>No students found</h3>
                            <p>There are no students matching your search criteria.</p>
                        </div>
                    </div>
                </div>

                <div id="section-markbook" class="page-section hidden">
                    <div class="content-header">
                        <div>
                            <h1>Academic Markbook</h1>
                            <p>Enter term marks, auto-calculate averages and grades</p>
                        </div>
                    </div>
                    <div class="table-container glass-panel form-grid"
                        style="grid-template-columns: 1fr; gap: 20px; padding: 20px; background: var(--bg-color); overflow: visible !important;">
                        <div class="search-container"
                            style="width: 100%; border-color: var(--panel-border); position: relative; overflow: visible; z-index: 50;">
                            <i class="fa-solid fa-user-graduate"></i>
                            <input type="text" id="markbookStudentSearch" class="input-icon-wrapper"
                                placeholder="Search student by ID or name to enter/view marks..."
                                style="width:100%; background:transparent; border:none; color:var(--text-alt); font-weight:700; outline:none; font-size:1rem;"
                                autocomplete="off">
                            <div id="markbookDropdown" class="autocomplete-dropdown hidden"></div>
                        </div>

                        <div id="markbookFormArea" class="hidden">
                            <div
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                                <div class="form-group">
                                    <label style="color: var(--text-alt);">Class / Grade</label>
                                    <select id="mbClass"
                                        style="width:100%; padding: 12px; background:var(--panel-bg); border:2px solid var(--panel-border); border-radius:12px; font-weight: 700; outline:none; color: var(--text-main);">
                                        <option value="Grade 6">Grade 6</option>
                                        <option value="Grade 7">Grade 7</option>
                                        <option value="Grade 8">Grade 8</option>
                                        <option value="Grade 9">Grade 9</option>
                                        <option value="Grade 10">Grade 10</option>
                                        <option value="Grade 11">Grade 11</option>
                                        <option value="Grade 12">Grade 12</option>
                                        <option value="Grade 13">Grade 13</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label style="color: var(--text-alt);">Subject</label>
                                    <input type="text" id="mbSubject" placeholder="Ex: Mathematics"
                                        style="width:100%; padding: 12px; background:var(--panel-bg); border:2px solid var(--panel-border); border-radius:12px; font-weight: 700;">
                                </div>
                                <div class="form-group">
                                    <label style="color: var(--text-alt);">Term 1 Marks</label>
                                    <input type="number" id="mbTerm1" min="0" max="100" placeholder="0-100"
                                        style="width:100%; padding: 12px; background:var(--panel-bg); border:2px solid var(--panel-border); border-radius:12px; font-weight: 700;">
                                </div>
                                <div class="form-group">
                                    <label style="color: var(--text-alt);">Term 2 Marks</label>
                                    <input type="number" id="mbTerm2" min="0" max="100" placeholder="0-100"
                                        style="width:100%; padding: 12px; background:var(--panel-bg); border:2px solid var(--panel-border); border-radius:12px; font-weight: 700;">
                                </div>
                                <div class="form-group">
                                    <label style="color: var(--text-alt);">Term 3 Marks</label>
                                    <input type="number" id="mbTerm3" min="0" max="100" placeholder="0-100"
                                        style="width:100%; padding: 12px; background:var(--panel-bg); border:2px solid var(--panel-border); border-radius:12px; font-weight: 700;">
                                </div>
                            </div>
                            <div style="margin-top:20px; text-align:right;">
                                <button id="saveMarksBtn" class="primary-btn"
                                    style="display:inline-flex; border-color: var(--text-alt);"><i
                                        class="fa-solid fa-save"></i> Save Marks</button>
                            </div>

                            <div
                                style="display:flex; justify-content:space-between; align-items:center; margin-top:30px; margin-bottom:15px; flex-wrap: wrap; gap: 15px;">
                                <h3 style="color: var(--text-alt); margin:0;">Current Academic
                                    Record</h3>
                                <div style="display:flex; align-items:center; gap:10px;">
                                    <label style="color: var(--text-alt); font-weight:700; font-size: 0.95rem;">Filter
                                        Class:</label>
                                    <select id="marksFilterClass"
                                        style="padding: 8px 12px; border-radius: 8px; border: 2px solid var(--panel-border); background: var(--panel-bg); color: var(--text-main); font-weight: 700; outline: none;">
                                        <option value="All">All Classes</option>
                                        <option value="Grade 6">Grade 6</option>
                                        <option value="Grade 7">Grade 7</option>
                                        <option value="Grade 8">Grade 8</option>
                                        <option value="Grade 9">Grade 9</option>
                                        <option value="Grade 10">Grade 10</option>
                                        <option value="Grade 11">Grade 11</option>
                                        <option value="Grade 12">Grade 12</option>
                                        <option value="Grade 13">Grade 13</option>
                                    </select>
                                </div>
                            </div>
                            <div style="width: 100%; overflow-x: auto;">
                                <table style="width:100%; min-width:600px;">
                                    <thead>
                                        <tr>
                                            <th style="background: var(--bg-color); color: var(--text-alt);">Class</th>
                                            <th style="background: var(--bg-color); color: var(--text-alt);">Subject
                                            </th>
                                            <th style="background: var(--bg-color); color: var(--text-alt);">Term 1</th>
                                            <th style="background: var(--bg-color); color: var(--text-alt);">Term 2</th>
                                            <th style="background: var(--bg-color); color: var(--text-alt);">Term 3</th>
                                            <th style="background: var(--bg-color); color: var(--text-alt);">Average
                                            </th>
                                            <th style="background: var(--bg-color); color: var(--text-alt);">Grade</th>
                                            <th style="background: var(--bg-color); color: var(--text-alt);">Actions
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody id="marksTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-analysis" class="page-section hidden">
                    <div class="content-header">
                        <div>
                            <h1>Grade 6-13 Historical Analysis</h1>
                            <p>Comprehensive performance analytics over 7 years</p>
                        </div>
                    </div>
                    <div class="table-container glass-panel"
                        style="padding: 20px; background: var(--bg-color); overflow: visible !important;">
                        <div class="search-container"
                            style="width: 100%; border-color: var(--panel-border); margin-bottom: 20px; position: relative; overflow: visible; z-index: 50;">
                            <i class="fa-solid fa-chart-bar"></i>
                            <input type="text" id="analysisStudentSearch" class="input-icon-wrapper"
                                placeholder="Search student by ID or name to view analysis..."
                                style="width:100%; background:transparent; border:none; color:var(--text-alt); font-weight:700; outline:none; font-size:1rem;"
                                autocomplete="off">
                            <div id="analysisDropdown" class="autocomplete-dropdown hidden"></div>
                        </div>
                        <div id="analysisContentArea" class="hidden">
                            <h3 style="color: var(--text-alt); margin-bottom: 15px;">Performance Overview</h3>
                            <div id="analysisCharts" style="display: flex; flex-direction: column; gap: 15px;">
                                <!-- Charts injected via JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <div id="section-promotion" class="page-section hidden">
                    <div class="content-header">
                        <div>
                            <h1>Promotion & Reporting</h1>
                            <p>Batch promotions and final progress report PDF generation</p>
                        </div>
                    </div>
                    <div class="table-container glass-panel">
                        <table id="promotionTable">
                            <thead>
                                <tr>
                                    <th>Admission ID</th>
                                    <th>Full Name</th>
                                    <th>Overall Average</th>
                                    <th>Status</th>
                                    <th>Final Report</th>
                                </tr>
                            </thead>
                            <tbody id="promotionTableBody">
                                <!-- Promotion rows injected via JS -->
                            </tbody>
                        </table>
                        <div id="promotionNoData" class="no-data hidden">
                            <div class="icon-circle">
                                <i class="fa-solid fa-award"></i>
                            </div>
                            <h3>No records available</h3>
                            <p>Students need marks entered before promotion analysis.</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal for Add/Edit Student -->
    <div id="studentModal" class="modal">
        <div class="modal-content glass-panel glow">
            <div class="modal-header">
                <div>
                    <h2 id="modalTitle">Register New Student</h2>
                    <p class="subtitle" id="modalSubtitle">Enter the student's admission details below.</p>
                </div>
                <button id="closeModalBtn" class="close-btn"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <form id="studentForm">
                <input type="hidden" id="editStudentId">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="admissionId">Admission ID</label>
                        <div class="input-icon-wrapper">
                            <i class="fa-solid fa-id-card"></i>
                            <input type="text" id="admissionId" required placeholder="Ex: ADM-2023-001">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="fullName">Full Name</label>
                        <div class="input-icon-wrapper">
                            <i class="fa-solid fa-user"></i>
                            <input type="text" id="fullName" required placeholder="Student's complete name">
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label for="address">Residential Address</label>
                        <div class="input-icon-wrapper">
                            <i class="fa-solid fa-map-location-dot"></i>
                            <input type="text" id="address" required placeholder="House number, street, city">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="birthday">Date of Birth</label>
                        <div class="input-icon-wrapper">
                            <i class="fa-solid fa-cake-candles"></i>
                            <input type="date" id="birthday" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="admissionDate">Admission Date</label>
                        <div class="input-icon-wrapper">
                            <i class="fa-solid fa-calendar-check"></i>
                            <input type="date" id="admissionDate" required>
                        </div>
                    </div>

                    <div class="form-divider full-width">Guardian Information</div>

                    <div class="form-group">
                        <label for="guardianName">Guardian's Name</label>
                        <div class="input-icon-wrapper">
                            <i class="fa-solid fa-user-tie"></i>
                            <input type="text" id="guardianName" required placeholder="Parent or guardian name">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="guardianContact">Guardian's Contact</label>
                        <div class="input-icon-wrapper">
                            <i class="fa-solid fa-phone"></i>
                            <input type="text" id="guardianContact" required placeholder="Phone number">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" id="cancelBtn" class="secondary-btn">Cancel</button>
                    <button type="submit" class="primary-btn"><i class="fa-solid fa-check"></i> Save Record</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="toast hidden">
        <i class="fa-solid fa-circle-check"></i>
        <span id="toastMessage">Success!</span>
    </div>

    <script src="script.js"></script>
</body>

</html>